nohup: ignoring input
all_vs_healthy
Pancreatic Cancer
Gender+Age
5000
Index(['Patient', 'Extracted_ID', 'Patient Type', 'Sample Type', 'Timepoint',
       'Age at Diagnosis', 'Gender', 'Stage', 'TNM Staging',
       'Site of Primary Tumor', 'Histopathological Diagnosis',
       'Degree of Differentiation', 'Location of Metastases at Diagnosis',
       'Volume of Plasma (ml)', 'cfDNA Extracted (ng/ml)',
       'cfDNA Input (ng/ml)', 'Whole Genome Fragment Profile  Analysis',
       'Targeted Fragment Profile Analysis', 'Targeted Mutation Analysis'],
      dtype='str')
Specific group: Pancancer
(99, 19)
(108, 19)
99
99
    sample       group chrom  bin  ...  wps_value    start      end      GC
0  EE85727  colorectal  chr1  184  ...  -0.329578   920000   925000  0.6632
1  EE85727  colorectal  chr1  214  ...  -0.352073  1070000  1075000  0.6486
2  EE85727  colorectal  chr1  233  ...  -0.309450  1165000  1170000  0.6758
3  EE85727  colorectal  chr1  234  ...  -0.687972  1170000  1175000  0.6190
4  EE85727  colorectal  chr1  235  ...  -0.328470  1175000  1180000  0.6104

[5 rows x 13 columns]
Index(['sample', 'group', 'chrom', 'bin', 'mean', 'median', 'stdev', 'min',
       'max', 'wps_value', 'start', 'end', 'GC'],
      dtype='str')
Number of Samples in Matrix: 198
Number of Bins per Sample: 5213.0
The median of age at diagnosis is: 64.0
STAGE 1: Fast Screening (all combinations)
Screening combination ('mean',)...
No NaNs in dataframe
  > Fast AUC: 0.807
Screening combination ('median',)...
No NaNs in dataframe
  > Fast AUC: 0.802
Screening combination ('stdev',)...
No NaNs in dataframe
  > Fast AUC: 0.822
Screening combination ('wps_value',)...
No NaNs in dataframe
  > Fast AUC: 0.694
Screening combination ('min',)...
No NaNs in dataframe
  > Fast AUC: 0.579
Screening combination ('max',)...
No NaNs in dataframe
  > Fast AUC: 0.739
Screening combination ('mean', 'median')...
No NaNs in dataframe
  > Fast AUC: 0.807
Screening combination ('mean', 'stdev')...
No NaNs in dataframe
  > Fast AUC: 0.847
Screening combination ('mean', 'wps_value')...
No NaNs in dataframe
  > Fast AUC: 0.759
Screening combination ('mean', 'min')...
No NaNs in dataframe
  > Fast AUC: 0.759
Screening combination ('mean', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.830
Screening combination ('median', 'stdev')...
No NaNs in dataframe
  > Fast AUC: 0.872
Screening combination ('median', 'wps_value')...
No NaNs in dataframe
  > Fast AUC: 0.747
Screening combination ('median', 'min')...
No NaNs in dataframe
  > Fast AUC: 0.782
Screening combination ('median', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.880
Screening combination ('stdev', 'wps_value')...
No NaNs in dataframe
  > Fast AUC: 0.739
Screening combination ('stdev', 'min')...
No NaNs in dataframe
  > Fast AUC: 0.772
Screening combination ('stdev', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.852
Screening combination ('wps_value', 'min')...
No NaNs in dataframe
  > Fast AUC: 0.594
Screening combination ('wps_value', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.679
Screening combination ('min', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.642
Screening combination ('mean', 'median', 'stdev')...
No NaNs in dataframe
  > Fast AUC: 0.857
Screening combination ('mean', 'median', 'wps_value')...
No NaNs in dataframe
  > Fast AUC: 0.754
Screening combination ('mean', 'median', 'min')...
No NaNs in dataframe
  > Fast AUC: 0.789
Screening combination ('mean', 'median', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.850
Screening combination ('mean', 'stdev', 'wps_value')...
No NaNs in dataframe
  > Fast AUC: 0.789
Screening combination ('mean', 'stdev', 'min')...
No NaNs in dataframe
  > Fast AUC: 0.762
Screening combination ('mean', 'stdev', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.852
Screening combination ('mean', 'wps_value', 'min')...
No NaNs in dataframe
  > Fast AUC: 0.772
Screening combination ('mean', 'wps_value', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.832
Screening combination ('mean', 'min', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.757
Screening combination ('median', 'stdev', 'wps_value')...
No NaNs in dataframe
  > Fast AUC: 0.787
Screening combination ('median', 'stdev', 'min')...
No NaNs in dataframe
  > Fast AUC: 0.797
Screening combination ('median', 'stdev', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.827
Screening combination ('median', 'wps_value', 'min')...
No NaNs in dataframe
  > Fast AUC: 0.784
Screening combination ('median', 'wps_value', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.762
Screening combination ('median', 'min', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.774
Screening combination ('stdev', 'wps_value', 'min')...
No NaNs in dataframe
  > Fast AUC: 0.702
Screening combination ('stdev', 'wps_value', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.812
Screening combination ('stdev', 'min', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.767
Screening combination ('wps_value', 'min', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.694
Screening combination ('mean', 'median', 'stdev', 'wps_value')...
No NaNs in dataframe
  > Fast AUC: 0.799
Screening combination ('mean', 'median', 'stdev', 'min')...
No NaNs in dataframe
  > Fast AUC: 0.797
Screening combination ('mean', 'median', 'stdev', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.840
Screening combination ('mean', 'median', 'wps_value', 'min')...
No NaNs in dataframe
  > Fast AUC: 0.704
Screening combination ('mean', 'median', 'wps_value', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.822
Screening combination ('mean', 'median', 'min', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.792
Screening combination ('mean', 'stdev', 'wps_value', 'min')...
No NaNs in dataframe
  > Fast AUC: 0.787
Screening combination ('mean', 'stdev', 'wps_value', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.877
Screening combination ('mean', 'stdev', 'min', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.827
Screening combination ('mean', 'wps_value', 'min', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.815
Screening combination ('median', 'stdev', 'wps_value', 'min')...
No NaNs in dataframe
  > Fast AUC: 0.752
Screening combination ('median', 'stdev', 'wps_value', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.855
Screening combination ('median', 'stdev', 'min', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.837
Screening combination ('median', 'wps_value', 'min', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.774
Screening combination ('stdev', 'wps_value', 'min', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.754
Screening combination ('mean', 'median', 'stdev', 'wps_value', 'min')...
No NaNs in dataframe
  > Fast AUC: 0.840
Screening combination ('mean', 'median', 'stdev', 'wps_value', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.872
Screening combination ('mean', 'median', 'stdev', 'min', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.842
Screening combination ('mean', 'median', 'wps_value', 'min', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.827
Screening combination ('mean', 'stdev', 'wps_value', 'min', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.830
Screening combination ('median', 'stdev', 'wps_value', 'min', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.767
Screening combination ('mean', 'median', 'stdev', 'wps_value', 'min', 'max')...
No NaNs in dataframe
  > Fast AUC: 0.830

Top 10 candidates found. Starting Stage 2 Deep Analysis...

STAGE 2: Full Benchmarking Top 10
No NaNs in dataframe
  > Full benchmarking for ('median', 'max')...
/labmed/workspace/lotta/.venv/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py:1160: UserWarning: Inconsistent values: penalty=l1 with l1_ratio=0.0. penalty is deprecated. Please use l1_ratio only.
  warnings.warn(
Fold 1/5...
  AUC = 0.734, Best C = 1526.4179671752302
Fold 2/5...
  AUC = 0.859, Best C = 494.1713361323828
Fold 3/5...
  AUC = 0.832, Best C = 2222.996482526191
Fold 4/5...
  AUC = 0.883, Best C = 4714.8663634573895
Fold 5/5...
  AUC = 0.825, Best C = 11.513953993264458
No NaNs in dataframe
  > Full benchmarking for ('mean', 'stdev', 'wps_value', 'max')...
/labmed/workspace/lotta/.venv/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py:1160: UserWarning: Inconsistent values: penalty=l1 with l1_ratio=0.0. penalty is deprecated. Please use l1_ratio only.
  warnings.warn(
Fold 1/5...
  AUC = 0.852, Best C = 339.3221771895323
Fold 2/5...
  AUC = 0.805, Best C = 109.85411419875572
Fold 3/5...
  AUC = 0.754, Best C = 719.6856730011514
Fold 4/5...
  AUC = 0.892, Best C = 4714.8663634573895
Fold 5/5...
  AUC = 0.850, Best C = 4714.8663634573895
No NaNs in dataframe
  > Full benchmarking for ('median', 'stdev')...
/labmed/workspace/lotta/.venv/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py:1160: UserWarning: Inconsistent values: penalty=l1 with l1_ratio=0.0. penalty is deprecated. Please use l1_ratio only.
  warnings.warn(
Fold 1/5...
  AUC = 0.660, Best C = 719.6856730011514
Fold 2/5...
  AUC = 0.863, Best C = 4714.8663634573895
Fold 3/5...
  AUC = 0.867, Best C = 10000.0
Fold 4/5...
  AUC = 0.904, Best C = 10000.0
Fold 5/5...
  AUC = 0.862, Best C = 10000.0
No NaNs in dataframe
  > Full benchmarking for ('mean', 'median', 'stdev', 'wps_value', 'max')...
/labmed/workspace/lotta/.venv/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py:1160: UserWarning: Inconsistent values: penalty=l1 with l1_ratio=0.0. penalty is deprecated. Please use l1_ratio only.
  warnings.warn(
Fold 1/5...
  AUC = 0.773, Best C = 1048.1131341546852
Fold 2/5...
  AUC = 0.820, Best C = 10000.0
Fold 3/5...
  AUC = 0.801, Best C = 10000.0
Fold 4/5...
  AUC = 0.900, Best C = 10000.0
Fold 5/5...
  AUC = 0.812, Best C = 6866.488450042998
No NaNs in dataframe
  > Full benchmarking for ('mean', 'median', 'stdev')...
/labmed/workspace/lotta/.venv/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py:1160: UserWarning: Inconsistent values: penalty=l1 with l1_ratio=0.0. penalty is deprecated. Please use l1_ratio only.
  warnings.warn(
Fold 1/5...
  AUC = 0.730, Best C = 232.99518105153672
Fold 2/5...
  AUC = 0.875, Best C = 2222.996482526191
Fold 3/5...
  AUC = 0.852, Best C = 2222.996482526191
Fold 4/5...
  AUC = 0.879, Best C = 339.3221771895323
Fold 5/5...
  AUC = 0.821, Best C = 3237.45754281764
No NaNs in dataframe
  > Full benchmarking for ('median', 'stdev', 'wps_value', 'max')...
/labmed/workspace/lotta/.venv/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py:1160: UserWarning: Inconsistent values: penalty=l1 with l1_ratio=0.0. penalty is deprecated. Please use l1_ratio only.
  warnings.warn(
Fold 1/5...
  AUC = 0.770, Best C = 1526.4179671752302
Fold 2/5...
  AUC = 0.781, Best C = 719.6856730011514
Fold 3/5...
  AUC = 0.719, Best C = 719.6856730011514
Fold 4/5...
  AUC = 0.904, Best C = 4714.8663634573895
Fold 5/5...
  AUC = 0.825, Best C = 719.6856730011514
No NaNs in dataframe
  > Full benchmarking for ('mean', 'stdev', 'max')...
/labmed/workspace/lotta/.venv/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py:1160: UserWarning: Inconsistent values: penalty=l1 with l1_ratio=0.0. penalty is deprecated. Please use l1_ratio only.
  warnings.warn(
Fold 1/5...
  AUC = 0.824, Best C = 109.85411419875572
Fold 2/5...
  AUC = 0.895, Best C = 3237.45754281764
Fold 3/5...
  AUC = 0.789, Best C = 3237.45754281764
Fold 4/5...
  AUC = 0.850, Best C = 6866.488450042998
Fold 5/5...
  AUC = 0.867, Best C = 75.43120063354607
No NaNs in dataframe
  > Full benchmarking for ('stdev', 'max')...
/labmed/workspace/lotta/.venv/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py:1160: UserWarning: Inconsistent values: penalty=l1 with l1_ratio=0.0. penalty is deprecated. Please use l1_ratio only.
  warnings.warn(
Fold 1/5...
  AUC = 0.777, Best C = 2222.996482526191
Fold 2/5...
  AUC = 0.906, Best C = 232.99518105153672
Fold 3/5...
  AUC = 0.773, Best C = 2222.996482526191
Fold 4/5...
  AUC = 0.871, Best C = 232.99518105153672
Fold 5/5...
  AUC = 0.800, Best C = 0.18420699693267145
No NaNs in dataframe
  > Full benchmarking for ('mean', 'median', 'max')...
/labmed/workspace/lotta/.venv/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py:1160: UserWarning: Inconsistent values: penalty=l1 with l1_ratio=0.0. penalty is deprecated. Please use l1_ratio only.
  warnings.warn(
Fold 1/5...
  AUC = 0.758, Best C = 4714.8663634573895
Fold 2/5...
  AUC = 0.879, Best C = 6866.488450042998
Fold 3/5...
  AUC = 0.836, Best C = 1048.1131341546852
Fold 4/5...
  AUC = 0.875, Best C = 6866.488450042998
Fold 5/5...
  AUC = 0.712, Best C = 10000.0
No NaNs in dataframe
  > Full benchmarking for ('mean', 'stdev')...
/labmed/workspace/lotta/.venv/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py:1160: UserWarning: Inconsistent values: penalty=l1 with l1_ratio=0.0. penalty is deprecated. Please use l1_ratio only.
  warnings.warn(
Fold 1/5...
  AUC = 0.871, Best C = 1048.1131341546852
Fold 2/5...
  AUC = 0.863, Best C = 4714.8663634573895
Fold 3/5...
  AUC = 0.867, Best C = 3237.45754281764
Fold 4/5...
  AUC = 0.892, Best C = 2222.996482526191
Fold 5/5...
  AUC = 0.892, Best C = 10000.0

--- FINAL RESULTS (Top 10) ---
Traceback (most recent call last):
  File "/labmed/workspace/lotta/finaletoolkit/ba_analysis_scripts/04_lasso_modeling.py", line 229, in <module>
    display(metrics_results)
    ^^^^^^^
NameError: name 'display' is not defined
==== Fragmentomics pipeline started ====


===== RUNNING BIN SIZE 5000 =====

[BIN 5000 | 04_lasso_modeling.py] START
[BIN 5000 | 04_lasso_modeling.py] FAILED after 1675.4s
